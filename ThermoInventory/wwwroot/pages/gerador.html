<!DOCTYPE html>
<html lang="pt-br">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>ThermoInventory - Gerador de Etiquetas</title>
        <link rel="icon" type="image/svg+xml" href="../assets/logo.svg">
        <link rel="stylesheet" href="../styles/reset.css">
        <link rel="stylesheet" href="../styles/root.css">
        <link rel="stylesheet" href="../styles/gerador.css">
        <link rel="stylesheet" href="../styles/navbar.css">
        <script src="https://cdn.jsdelivr.net/npm/easyqrcodejs@4.6.0/dist/easy.qrcode.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    </head>
    <body>
        <div data-include-html="../components/navbar.html"></div>
    
        <main class="container-principal">
            <div class="card">
                <div class="card-header">
                    <h1>Gerador de Etiquetas</h1>
                </div>
    
                <div class="tab-nav">
                    <button class="tab-btn active" data-tab="tab-manual">Contagem Manual</button>
                    <button class="tab-btn" data-tab="tab-padrao">Lote Sequencial (Padrão)</button>
                    <button class="tab-btn" data-tab="tab-endereco">Endereço</button>
                    <button class="tab-btn" data-tab="tab-lote">Lote por Quantidade</button>
                </div>
    
                <div class="card-body">
                    <div id="tab-manual" class="tab-pane active">
                        <div class="form-group">
                            <label for="manual-descricao">Descrição do Produto:</label>
                            <input type="text" id="manual-descricao" placeholder="Ex: PERFIL EPDM I 12 X 43MM">
                        </div>
                        <div class="form-group">
                            <label for="manual-codigo">Código do Produto:</label>
                            <input type="text" id="manual-codigo" placeholder="Ex: 025.0013">
                        </div>
                        <button id="btn-gerar-manual" class="btn">Gerar Etiqueta Manual</button>
                    </div>
    
                    <div id="tab-padrao" class="tab-pane">
                        <div class="form-group">
                            <label for="ordemProducao">Número da Ordem de Produção:</label>
                            <input type="text" id="ordemProducao" placeholder="Ex: OP202509">
                        </div>
                        <div class="form-group">
                            <label for="quantidade">Quantidade de Etiquetas:</label>
                            <input type="number" id="quantidade" placeholder="Ex: 5">
                        </div>
                        <div class="form-group">
                            <label for="codigoProduto">Código do Produto:</label>
                            <input type="text" id="codigoProduto" placeholder="Ex: 001.0112">
                        </div>
                        <button id="btnGerarEtiquetas" class="btn">Gerar Etiquetas em Lote</button>
                    </div>
                    
                    <div id="tab-endereco" class="tab-pane">
                        <div class="form-group">
                            <label for="endereco-nome">Nome do Endereço:</label>
                            <input type="text" id="endereco-nome" placeholder="Ex: PP-01/00">
                        </div>
                        <button id="btn-gerar-endereco" class="btn">Gerar Etiqueta de Endereço</button>
                    </div>

                    <div id="tab-lote" class="tab-pane">
                        <div class="form-group">
                            <label for="nota-fiscal">Nota Fiscal:</label>
                            <input type="number" id="nota-fiscal" placeholder="Ex: 1000">
                        </div>
                        <div class="form-group">
                            <label for="lote-total">Quantidade Total:</label>
                            <input type="number" id="lote-total" placeholder="Ex: 1000">
                        </div>
                        <div class="form-group">
                            <label for="lote-por-caixa">Quantidade por Embalagem/Caixa:</label>
                            <input type="number" id="lote-por-caixa" placeholder="Ex: 200">
                        </div>
                        <div class="form-group">
                            <label for="lote-codigo-produto">Código do Produto:</label>
                            <input type="text" id="lote-codigo-produto" placeholder="Ex: 021.0010">
                        </div>
                        <div class="form-group">
                            <label for="lote-desc-produto">Descrição do Produto:</label>
                            <input type="text" id="lote-desc-produto" placeholder="Ex: PARAF SEXT 10X45">
                        </div>
                        <button id="btn-gerar-lote" class="btn">Gerar Etiquetas de Lote</button>
                    </div>
                </div>
            </div>
        </main>
    
        <div id="qrcode-container" style="display: none;"></div>
    
        <script type="module" src="../scripts/component-loader.js"></script>
        <script type="module">
            import { 
                gerarEtiquetasEmLotePDF, 
                gerarEtiquetaManualPDF, 
                gerarEtiquetaEnderecoPDF, 
                gerarEtiquetasLotePDF 
            } from '../scripts/etiqueta-generator.js';
    
            const btnGerarLote = document.getElementById('btnGerarEtiquetas');
            btnGerarLote.addEventListener('click', () => {
                const op = document.getElementById('ordemProducao').value;
                const qtd = document.getElementById('quantidade').value;
                const prod = document.getElementById('codigoProduto').value;
                
                if (!op || !qtd || !prod) {
                    alert("Por favor, preencha todos os campos da Geração em Lote.");
                    return;
                }
                
                gerarEtiquetasEmLotePDF(op, qtd, prod);
            });
    
            const btnGerarManual = document.getElementById('btn-gerar-manual');
            btnGerarManual.addEventListener('click', () => {
                const desc = document.getElementById('manual-descricao').value;
                const cod = document.getElementById('manual-codigo').value;
                
                if (!desc || !cod) {
                    alert("Por favor, preencha a Descrição e o Código do Produto.");
                    return;
                }
                
                gerarEtiquetaManualPDF(desc, cod);
            });

            const btnGerarEndereco = document.getElementById('btn-gerar-endereco');
            btnGerarEndereco.addEventListener('click', () => {
                const endereco = document.getElementById('endereco-nome').value;
                
                if (!endereco) {
                    alert("Por favor, preencha o nome do Endereço.");
                    return;
                }
                
                gerarEtiquetaEnderecoPDF(endereco);
            });

            const btnGerarLoteQuantidade = document.getElementById('btn-gerar-lote');
            btnGerarLoteQuantidade.addEventListener('click', () => {
                const notaFiscal = document.getElementById('nota-fiscal').value;
                const total = document.getElementById('lote-total').value;
                const porCaixa = document.getElementById('lote-por-caixa').value;
                const desc = document.getElementById('lote-desc-produto').value;
                const cod = document.getElementById('lote-codigo-produto').value;

                if (!notaFiscal || !total || !porCaixa || !desc || !cod) {
                    alert("Por favor, preencha todos os campos da Geração por Lote.");
                    return;
                }
                gerarEtiquetasLotePDF(notaFiscal, total, porCaixa, desc, cod);
            });
    
            const tabButtons = document.querySelectorAll('.tab-btn');
            const tabPanes = document.querySelectorAll('.tab-pane');
    
            tabButtons.forEach(button => {
                button.addEventListener('click', () => {
                    tabButtons.forEach(btn => btn.classList.remove('active'));
                    button.classList.add('active');
    
                    const targetTab = document.getElementById(button.dataset.tab);
                    tabPanes.forEach(pane => pane.classList.remove('active'));
                    targetTab.classList.add('active');
                });
            });
        </script>
    </body>
</html>